# Камень-Ножницы-Бумага

## Правила игры
В одной игре _два_ бота играют друг против друга.

Во время одного _хода_ каждый бот выбирает одну из трёх фигур: камень, ножницы или бумагу. Если оба бота выбрали одинаковую фигуру, во время хода объявляется ничья. В противном случае _победитель хода_ определяется следующим образом:
- камень побеждает ножницы
- ножницы побеждают бумагу
- бумага побеждает камень

Несколько _ходов_ образуют _сет_. Сет проводится до тех пор, пока один из ботов не одержал победу _требуемое количество раз_ (которое задаётся параметром). Такой бот считается _победителем сета_.

В рамках всей _игры_ проводится несколько _сетов_. Параметром задаётся _максимальное количество сетов_. Бот, одержавший победу в наибольшем количестве сетов, побеждает по всей игре. Если после проведения максимального количества сетов оба бота одержали победу в одинаковом количестве сетов, в игре объявляется ничья.

 Если победитель известен до проведения максимального количества сетов, игра останавливается. Например, _максимальное количество сетов_ = 7, и после проведения 4 сетов один из ботов уже одержал 4 победы; в этом случае победитель игры однозначно определён, и игра останавливается. 

Если в рамках одного сета _ничья объявляется 10 ходов подряд_, ничья объявляется в рамках всей игры.

## Разработка ботов

### Порядок запуска и остановки ботов
Каждый бот, участвующий в турнире, _запускается перед началом игры и останавливается после неё._ Таким образом, время жизни бота равно одной игре. Перед началом следующей игры бот будет снова запущен и после следующей игры будет снова остановлен и т.д.

Следовательно, состояние бота (т.е. состояние его памяти — значения переменных и т.д.) сохраняется на протяжении одной игры. Каждую игру бот начинает из начального состояния.

### Интерфейс бота и порядок вызовов
Для разработки ботов требуется написать реализацию его интерфейса на одном из поддерживаемых языков программирования. Интерфейс содержит 4 функции:

|Функция|Параметры|Возвращает|Описание|Ограничение по времени|
|---|---|---|---|---|
|`setParameters`|`setCount: int`  <br>`winsPerSet: int`||Вызывается один раз перед началом игры.  <br>  <br>Передаёт параметры, с которыми запущен турнир:  <br>- `setCount`: максимальное количество сетов в игре  <br>- `winsPerSet`: требуемое количество побед в сете|5 секунд|
|`onGameStart`|_Нет_||Вызывается один раз в начале игры.|5 секунд|
|`choose`|`previousOpponentChoice: int`|`int`|Функция должна вернуть число от 1 до 3, соответствующее фигуре, которую выбрал бот  <br>(1 - Камень, 2 - Бумага, 3 - Ножницы).  <br>  <br>Передаваемый параметр  <br>`previousOpponentChoice` - число от 1 до 3, выбор противника на предыдущем ходу.  <br>Самый первый раз за игру, при первом вызове choose, `previousOpponentChoice` равен 0  <br>(т.к. предыдущих ходов ещё не было).|1.5 секунды|
|`onGameEnd`|_Нет_||Вызывается один раз в конце игры.|5 секунд|
  
  
Во время игры функции вызываются в следующем порядке:
1. `setParameters(..., ...)` один раз перед началом игры
2. `onGameStart()` один раз в начале игры
3. `choose(0)` — самый первый вызов `choose`, на самом первом ходу в игре; значение `previousOpponentChoice` равно 0, так как предыдущих ходов ещё не было.
4. `choose(...)` много раз до окончания игры
5. `onGameEnd()`

На каждый из вызовов установлено ограничение времени, в течение которого бот должен выполнить вызванную функцию.

Обратите внимание, что если противник выполняет вызовы некорректно (см. ниже в правилах проведения турнира), то игра может быть закончена досрочно, и вызов _onGameEnd()_ может произойти раньше ожидаемого.

### Шаблоны ботов для разных языков программирования
При создании нового бота в AI Battle, откроется редактор кода с уже заполненным шаблоном для бота. _Шаблон бота не реализует никакой разумной стратегии, но корректно играет по правилам и сразу может быть принят в турнир._

В этом репозитории можно найти шаблоны для [Pascal (FPC 3.2.0)](./template.pas) и [Python 3.9](./template.py).
    
### Проверка бота перед принятием в турнир
Для того, чтобы бот был принят в турнир, он должен отвечать двум требованиям:
- код не должен содержать ошибок, препятствующих запуску бота
- бот должен играть по установленным правилам

Для этого, после нажатия кнопки "Отправить", выполняются следующие шаги:
1. Бот компилируется (для интерпретируемых языков — этап компиляции либо пропускается, либо состоит в проверке корректности синтаксиса)
2. Выполняется одна тестовая игра с ботом (требуемое количество побед в сете = 3, максимальное количество сетов = 3).

В случае возникновения ошибок на данных этапах после отправки будут показаны уведомления на странице редактирования бота. 
Доступны ошибки и предупреждения компиляции, лог тестовой игры, вывод бота во время тестовой игры.

## Правила проведения турнира
Для каждого запуска турнира задаётся два параметра: _требуемое количество побед в сете_ и _максимальное количество сетов_.

Каждый бот играет с каждым по одному разу. Например, если в турнире 5 участников, всего будет проведено 4 + 3 + 2 + 1 = 10 игр.

Если в игре объявлена ничья, оба участника получают по 1 очку. Если один из ботов одержал победу, он получает 3 очка, а его противник — 0 очков.

Турнирная таблица строится по сумме полученных очков. Чем больше очков у бота, тем выше он в турнирной таблице. Если два бота получили одинаковое количество очков в рамках турнира, они располагаются на одном месте.

### Исключительные ситуации
Во время проведения игры могут возникать исключительные ситуации: один из ботов может остановиться из-за программной ошибки, не ответить в рамках отведённого времени, или вернуть некорректный результат.

Все вызовы в игре выполняются одновременно для обоих участников. Если один и тот же вызов (например, _choose_) один из ботов выполнил некорректно (не ответил, сыграл не по правилам и т.д.), а второй — корректно, то второй бот объявляется победителем игры. Если оба бота выполнили вызов некорректно, _оба бота получают 0 очков._

После некорректного ответа _бот не исключается из турнира и будет продолжать участвовать в следующих играх_.